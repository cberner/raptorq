matrix:
  fast_finish: true
  include:
    - name: Run tests
      language: rust
      rust: stable
      before_script:
        - cargo install cargo-lichking
        - rustup component add rustfmt
        - rustup component add clippy
      install:
        []
      script:
        - make test

    - name: Run CPython wrapper tests
      language: rust
      rust: nightly
      before_script:
        - sudo apt update && sudo apt install python3 python3-pip python3-dev
        - pip3 install maturin virtualenv
      install:
        - python3 -m virtualenv venv
      script:
        - source venv/bin/activate && make -C python test
